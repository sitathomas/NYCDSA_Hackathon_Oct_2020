library(tidyverse)
setwd('/Users/jameswelch/Dropbox (Personal)/NYDSA/Work/Hackathons/Customer Churn Hackathon Dataset')
churn_trunc <- read_csv("./trunc_churn.csv")
members_trunc <- read_csv("./trunc_members.csv")
transaction_trunc <- read_csv("./trunc_transaction.csv")
users_trunc <- read_csv("./trunc_users.csv")
library(tidyverse)
library(ggplot2)
setwd('/Users/jameswelch/Dropbox (Personal)/NYDSA/Work/Hackathons/Customer Churn Hackathon Dataset')
churn_trunc <- read_csv("./trunc_churn.csv")
members_trunc <- read_csv("./trunc_members.csv")
transaction_trunc <- read_csv("./trunc_transaction.csv")
users_trunc <- read_csv("./trunc_users.csv")
members_trunc <- members_trunc %>% mutate(.,registration_init_time = as.Date(as.character(registration_init_time),"%Y%m%d"))
transaction_trunc <- transaction_trunc %>%  mutate(.,transaction_date = as.Date(as.character(transaction_date),"%Y%m%d"))
transaction_trunc <- transaction_trunc %>%  mutate(.,membership_expire_date = as.Date(as.character(membership_expire_date), format = "%Y %m %d"))
users_trunc <- users_trunc %>%  mutate(.,date = as.Date(as.character(date),"%Y%m%d"))
print("Churn Dataframe")
print(paste0("total entires: ", length(churn_trunc$is_churn)))
print(paste0("number unique msno: ",length(unique(churn_trunc$msno))))
print(paste0("total churns: ", sum(churn_trunc$is_churn)))
print(paste0("percentage churns: ", sum(churn_trunc$is_churn)/length(churn_trunc$is_churn)*100, "%"))
print("Churn Dataframe")
print(paste0("total entires: ", length(churn_trunc$is_churn)))
print(paste0("number unique msno: ",length(unique(churn_trunc$msno))))
print(paste0("total churns: ", sum(churn_trunc$is_churn)))
print(paste0("percentage churns: ", sum(churn_trunc$is_churn)/length(churn_trunc$is_churn)*100, "%"))
members_trunc <- members_trunc %>% mutate(.,registration_init_time = as.Date(as.character(registration_init_time),"%Y%m%d"))
transaction_trunc <- transaction_trunc %>%  mutate(.,transaction_date = as.Date(as.character(transaction_date),"%Y%m%d"))
transaction_trunc <- transaction_trunc %>%  mutate(.,membership_expire_date = as.Date(as.character(membership_expire_date), format = "%Y %m %d"))
users_trunc <- users_trunc %>%  mutate(.,date = as.Date(as.character(date),"%Y%m%d"))
users_seg <- join(users_trunc,churn_trunc, by='msno', all = TRUE)
users_seg <- merge(users_trunc,churn_trunc, by='msno', all = TRUE)
users_seg <- merge(users_trunc,churn_trunc, by='msno', all = TRUE)
head(users_seg)
users_seg <- merge(users_trunc,churn_trunc, by='msno', all = TRUE)
head(x, n=20)
head(users_seg, n=20L)
head(users_seg, n=20)
head(users_seg)
head(users_seg,20)
View(users_seg)
count(is.na(users_seg$date))
sum(is.na(users_seg$date))
#head(users_seg,20)
library(tidyverse)
library(ggplot2)
setwd('/Users/jameswelch/Dropbox (Personal)/NYDSA/Work/Hackathons/Customer Churn Hackathon Dataset')
churn_trunc <- read_csv("./trunc_churn.csv")
members_trunc <- read_csv("./trunc_members.csv")
transaction_trunc <- read_csv("./trunc_transaction.csv")
users_trunc <- read_csv("./trunc_users.csv")
library(tidyverse)
library(ggplot2)
setwd('/Users/jameswelch/Dropbox (Personal)/NYDSA/Work/Hackathons/NYCDSA_Hackathon_Oct_2020/James')
churn_trunc <- read_csv("./trunc_churn.csv")
members_trunc <- read_csv("./trunc_members.csv")
transaction_trunc <- read_csv("./trunc_transaction.csv")
users_trunc <- read_csv("./trunc_users.csv")
members_trunc <- members_trunc %>% mutate(.,registration_init_time = as.Date(as.character(registration_init_time),"%Y%m%d"))
transaction_trunc <- transaction_trunc %>%  mutate(.,transaction_date = as.Date(as.character(transaction_date),"%Y%m%d"))
transaction_trunc <- transaction_trunc %>%  mutate(.,membership_expire_date = as.Date(as.character(membership_expire_date), format = "%Y %m %d"))
users_trunc <- users_trunc %>%  mutate(.,date = as.Date(as.character(date),"%Y%m%d"))
users_trunc <- read_csv("./trunc_users.csv")
View(users_trunc)
# members_trunc <- members_trunc %>%
#   mutate(.,registration_init_time = as.Date(as.character(registration_init_time),"%Y%m%d"))
# transaction_trunc <- transaction_trunc %>%
#  mutate(.,transaction_date = as.Date(as.character(transaction_date),"%Y%m%d"))
#transaction_trunc <- transaction_trunc %>%
#  mutate(.,membership_expire_date = as.Date(as.character(membership_expire_date), format = "%Y %m %d"))
users_truncs <- users_trunc %>%
mutate(.,date = as.Date(as.character(date),format = "%Y%m%d"))
View(users_truncs)
# members_trunc <- members_trunc %>%
#   mutate(.,registration_init_time = as.Date(as.character(registration_init_time),"%Y%m%d"))
# transaction_trunc <- transaction_trunc %>%
#  mutate(.,transaction_date = as.Date(as.character(transaction_date),"%Y%m%d"))
#transaction_trunc <- transaction_trunc %>%
#  mutate(.,membership_expire_date = as.Date(as.character(membership_expire_date), format = "%Y %m %d"))
users_trunc <- users_trunc %>%
mutate(.,date = as.Date(as.character(date),format = "%Y%m%d"))
View(users_trunc)
users_seg <- merge(users_trunc,churn_trunc, by='msno', all = TRUE)
sum(is.na(users_seg$date))
#head(users_seg,20)
pwd
